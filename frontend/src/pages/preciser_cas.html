<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <title>Gestion Étapes et Tâches</title>
    
    <link rel="stylesheet" href="../css/dashboard_r.css">
    <style>
        
        .container {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 80%;
    max-width: 800px;
    text-align: center;
    margin-top: 119px;
    margin-right: 110px;
    height: 37vh;
    transition: box-shadow 0.3s ease-in-out; 
}

.container:hover {
    box-shadow: 0 6px 14px rgba(0, 0, 0, 0.15); 
}

        
        button {
    margin: 80px;
    border-radius: 10px;
    padding: 10px 15px;
    border: none;
    cursor: pointer;
    position: absolute;
    top: 200px;
    display: inline-block;
    color: white;
    font-size: 16px;
}

/* Bouton Valider */
.btn-success {
    background-color: #8F00FF;
    transform: scale(1.02);
    position: absolute;
    left: 940px;
    border: none;
    transition: background 0.3s, transform 0.2s;
    
}

.btn-success:hover {
    background-color: #6F00FF;
    transform: scale(1.04);
}

/* Titre */
h2 {
    color: #8A2BE2;
    margin-bottom: 20px;
    font-size: 24px;
}

/* Sélection du thème */
#theme-select {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 2px solid #8A2BE2;
    background: #F8F8FF;
    font-size: 16px;
    transition: background 0.3s, transform 0.2s;
}

#theme-select:focus {
    border-color: #6A0DAD;
    outline: none;
}


#group-select{
    position:absolute;
    top: 160px;
    width:55%;
    right: 165px;
}


    </style>
</head>
<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2 class="titre">Gestion projet</h2>
        <nav>
            <ul>
                <li>
                    <a href="dashboard_r.html">
                        <i class="fas fa-tachometer-alt"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="consulter_binome_r.html">
                        <i class="fas fa-users"></i> Voir binomes
                    </a>
                </li>
                <li>
                    <a href="decrire_sujet.html">
                        <i class="fas fa-file-alt"></i> Décrire Sujet
                    </a>
                </li>
                <li>
                    <a href="preciser_sujet.html">
                        <i class="fas fa-tasks"></i> Gestion Etape
                    </a>
                </li>

                <li class="active">
                    <a href="preciser_cas.html">
                        <i class="fas fa-tasks"></i> Preciser cas
                    </a>
                </li>
                <li >
                    <a href="organiser_reunion.html">
                        <i class="fas fa-calendar-check"></i> Organiser Reunion
                    </a>
                </li>

                <li  >
                    <a href="consulter_rap_ens_res.html">
                        <i class="fas fa-calendar-check"></i> Voir Rapport
                    </a>
                </li>
                <li ><a href="consulter_question.html"><i class="fas fa-comments"></i> Voir Question</a></li>

                <li>
                    <a href="voir_profil_r.html">
                        <i class="fas fa-user"></i> Voir profil
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <div class="container">
        <select id="group-select" class="form-select mb-3">
            <option value="">Sélectionner un théme</option>
            <!-- Options chargées dynamiquement -->
        </select>
        <button class="btn btn-success" id="valider-theme">ajouter cas</button>
           
    </div>
<script>

    document.addEventListener("DOMContentLoaded", function () {
            const idResponsable = localStorage.getItem("idResponsable");
            const select = document.getElementById("group-select");
        
            if (!idResponsable) {
                console.error("Aucun idResponsable trouvé dans localStorage");
                return;
            }
        
            // Récupérer les sujets affectés à cet enseignant
            fetch(`http://localhost:3000/api/sujets-par-responsable/${idResponsable}`)
            .then((res) => res.json())
                .then((data) => {
                    data.forEach((sujet) => {
                        const option = document.createElement("option");
                        option.value = sujet.idS;
                        option.textContent = sujet.titre;
                        select.appendChild(option);
                    });
                })
                .catch((err) => {
                    console.error("Erreur lors du chargement des sujets :", err);
                });
        
    document.getElementById("valider-theme").addEventListener("click", function() {
                const selectedSujetId = select.value;
                if (!selectedSujetId) {
                    alert("Veuillez sélectionner un thème");
                    return;
                }
        
                // Stocker le sujet sélectionné pour l'utiliser dans la page suivante
                localStorage.setItem("selectedSujetIdCas", selectedSujetId);
        window.location.href = "preciser_cas_r.html"; 
            });
        });


</script>
</body>
</html>